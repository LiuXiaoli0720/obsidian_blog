## 技术路线  
  
原始EEG信号 -> 溯源 & 频段分解：  
- 采样率 1 kHz → 0.5-70 Hz 带通 + ICA 去眼电。    
- 用 eLORETA/sLORETA 把 64 通道信号逆向重构到 **68 个 Desikan-Killiany 皮层 ROI** 的源活动时间序列。    
- 对每个 ROI 的时间序列做 Morlet 小波变换，提取 **θ(4-8 Hz)、α(8-13 Hz)、β(13-30 Hz)** 三个频段的瞬时幅值。    
→ 得到张量 **$X∈ℝ^{(68×3×T)}$**，T 为试次长度（秒×采样率）。  
  
动态脑网络构建：  
- **滑动窗口**：窗口 1 s，步长 0.25 s，得到 $N_{win} = (T-1)/0.25+1$ 个时间点。    
- **连边权重**：在每个窗口内计算 ROI 两两之间的 **加权相位滞后指数 wPLI**（或 dPAC），得到动态邻接矩阵序列 **${A_t∈ℝ^{(68×68)}}，t=1…N_{win}$**。    
- **阈值 + 稀疏化**：保留每个 A_t 中 wPLI>95th percentile 的边，减少 90% 冗余连接，防止 GNN 过平滑。    
→ 得到一组动态图 **$G_t=(V, E_t)$**，节点数固定为 68，边随时间变化。  
  
节点初始特征：  
由于溯源后ROI没有天然特征，采用以下两种互补策略：  
```  
# 方法A：功能特征  
node_feat = [mean_power, spectral_entropy, peak_freq]  # 3 维  
# 方法B：结构-位置编码  
pos_enc = laplacian_eigenvectors(adj, k=8)             # 8 维  
x = torch.cat([node_feat, pos_enc], dim=-1)            # 11 维  
```  
  
时空图神经网络设计：  
采用 **“动态图 + 时空卷积”** 的混合架构：    
• **空间卷积层**：GraphSAGE 或 GAT，每一层聚合 2-hop 邻居；    
• **时间卷积层**：1×3 depth-wise causal Conv 沿时间轴滑动；    
• **池化读出**：  
- 节点级：输出每个 ROI 的 64 维嵌入 **$h_i∈ℝ^{64}$**；  
- 图级：对所有节点做 attention pooling，获得试次嵌入 **$h_G∈ℝ^{128}$**。    
    整体模型用PyTorch Geometric实现。  
  
认知任务标签 & 训练：  
- 任务范式：n-back (0-back v.s. 2-back)  
- 损失函数：交叉熵损失+额外”必要脑区发现“约束  
```  
loss = CE(y_hat, y) + λ * sum(|α_i|)   # α_i 为第 i 个 ROI 的 attention gate  
```  
$\lambda > 0$促使网络仅保留少量高attention的节点。  
  
 提取必要脑区/网络  
 - 训练完成后，对每个试次计算 **节点 attention 向量 α∈ℝ^68**  
 - 跨被试/跨试次做 **单样本 t-test**（α>均值+2SD 视为显著）  
 - 将显著节点映射到 Brodmann 区 → 得到 **“工作记忆核心子网”**（典型结果：dlPFC、IPS、ACC、尾状核）。  
 - **子图可视化**：用 NetworkX 画显著子网，节点大小=α，边权重=平均 wPLI，颜色按模块度分区。  
  
解释性验证  
- **消融实验**：把 attention 最高的 20% 节点从图中整体剔除 → 模型准确率下降 >15%，验证其必要性；  
- **置换检验**：随机打乱 ROI 标签 1000 次，观察 α 分布是否仍显著集中；  
- **可重复性**：跨两个独立数据集（内部采集+公开 HCP-EEG）复现，Dice>0.75。  
  
